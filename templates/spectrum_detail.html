{% extends "base.html" %}

{% block head %}
    <script type="text/javascript" src="/static/js/d3.js"></script>
    <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
    <link rel="stylesheet" type="text/css" href="/static/css/graph.css" />
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
    <style type="text/css">        
        #details table{
            width:100%;
        }
        .span10 h1{
            text-align: center;
        }
        #frame{
            width:30px;
            margin:0;
            text-align: center;
        }
        #frame-slider{
            height: 10px;
        }
        #options>*{
            margin:5px 0;
        }
    </style>
    <script type="text/javascript">
    var m_id = {{meta_data.m_id}};
    $(function() {
        // preloadData(0,100);
        $( "#frame-slider" ).slider({
          value: 0,
          min: 0,
          max: 1000,
          slide: function( event, ui ){
            getData(ui.value);
            $("#frame").val(ui.value);
        },
        change: function(event, ui){
            getData(ui.value);
            $("#frame").val(ui.value);
        }
    });
        $("#frame").change(function(){
            console.log($("#frame-slider").slider("option", "value"));
            $("#frame-slider").slider("option", "value", $(this).val().replace(/[a-zA-Z]/g, ""));
        });
    });
    </script>
{% endblock head %}

{% block nav %}
    <li class="nav-header">Index</li>
    <li><a href="#graph">Graph</a></li>
    <li><a href="#details">Details</a></li>
    <li><a href="/plot/{{meta_data.m_id}}/img/?download=1">Download Image</a></li>
{% endblock nav %}

{% block content %}
    <h1>Plot {{meta_data.m_id}}</h1>
    <div class="graph" id="graph" oncontextmenu="return false">
        <h2>Spectrum Graph</h2>

    </div>
    <script type="text/javascript" src="/static/js/spectrum_graph.js"></script>
    <div id = "options">
        <div class="btn-group">
            <button class="btn" href="#" onclick="moveFrame(-1)"><i class="icon-chevron-left"></i></button>
            <input type="text" id="frame" value="0"/>
            <button class="btn" href="#" onclick="moveFrame(1)"><i class="icon-chevron-right"></i></button>
            <button id = "restore" class="btn" onclick = "restoreScale()">Fit Graph</button>
        </div>
        <div id="frame-slider"></div>
    </div>
    <div id="details">
        <h2>Spectrum Details</h2>
        <table class="table table-striped table-hover table-condensed">
            <thead>
                <tr>
                    <th>Attribute</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                {% for detail in details %}
                <tr>
                    <td>{{detail.0|capfirst}}</td>
                    <td>{{detail.1}}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock content %}
